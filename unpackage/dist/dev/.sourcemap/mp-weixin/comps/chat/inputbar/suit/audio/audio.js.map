{"version":3,"sources":["webpack:////Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/comps/chat/inputbar/suit/audio/audio.vue?eb67","webpack:////Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/comps/chat/inputbar/suit/audio/audio.vue?1869","webpack:////Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/comps/chat/inputbar/suit/audio/audio.vue?dad1","webpack:////Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/comps/chat/inputbar/suit/audio/audio.vue?33a9","webpack:////Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/comps/chat/inputbar/suit/audio/audio.vue","webpack:////Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/comps/chat/inputbar/suit/audio/audio.vue?5eae","webpack:////Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/comps/chat/inputbar/suit/audio/audio.vue?b091"],"names":["WebIM","require","msgType","RECORD_CONST","RecordStatus","RecordDesc","disp","msgStorage","RunAnimation","InitHeight","data","changedTouches","recordStatus","HIDE","radomheight","recorderManager","wx","getRecorderManager","recordClicked","isLongPress","components","props","username","type","Object","default","chatType","String","SINGLE_CHAT","created","beforeMount","moved","destroyed","mounted","methods","toggleWithoutAction","e","toggleRecordModal","setData","SHOW","handleRecordingMove","touches","SWIPE","pageY","HOLD","handleRecording","me","setTimeout","executeRecord","getSetting","success","res","recordAuth","authSetting","openSetting","uni","showToast","title","icon","startRecord","authorize","scope","fail","myradom","onStart","start","format","handleRecordingCancel","RELEASE","onStop","console","log","duration","uploadRecord","tempFilePath","stop","isGroupChat","CHAT_ROOM","getSendToParam","groupId","your","dur","str","config","appkey","split","token","conn","context","accessToken","uploadFile","url","filePath","name","header","Authorization","id","getUniqueId","msg","message","AUDIO","dataObj","JSON","parse","set","apiUrl","apiURL","body","uri","entities","uuid","filetype","filename","length","Math","ceil","from","myName","to","roomType","argument","fire","setGroup","send","obj","saveSendMsg","evt","saveMsg","that","_radomheight","i","random","toFixed"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;AACa;;;AAGjE;AAC4N;AAC5N,gBAAgB,iNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA+3B,CAAgB,myBAAG,EAAC,C;;;;;;;;;;;;mICAn5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIA,KAAK,GAAGC,mBAAO,CAAC,oCAAD,CAAP,CAAsC,SAAtC,CAAZ;AACA,IAAIC,OAAO,GAAGD,mBAAO,CAAC,0BAAD,CAArB;AACA,IAAIE,YAAY,GAAGF,mBAAO,CAAC,0BAAD,CAA1B;AACA,IAAIG,YAAY,GAAGD,YAAY,CAACC,YAAhC;AACA,IAAIC,UAAU,GAAGF,YAAY,CAACE,UAA9B;AACA,IAAIC,IAAI,GAAGL,mBAAO,CAAC,wCAAD,CAAlB;AACA,IAAIM,UAAU,GAAGN,mBAAO,CAAC,6BAAD,CAAxB;AACA,IAAIO,YAAY,GAAG,KAAnB;AACA,IAAMC,UAAU,GAAG,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,EAAa,EAAb,EAAiB,EAAjB,EAAqB,EAArB,EAAyB,EAAzB,EAA6B,EAA7B,EAAiC,EAAjC,EAAqC,EAArC,EAAyC,EAAzC,EAA6C,EAA7C,EAAiD,EAAjD,EAAqD,EAArD,EAAyD,EAAzD,EAA6D,EAA7D,EAAiE,EAAjE,EAAqE,EAArE,EAAyE,EAAzE,EAA6E,EAA7E,EAAiF,EAAjF,EAAqF,EAArF,CAAnB,C;;AAEe;AACbC,MADa,kBACN;AACL,WAAO;AACLC,oBAAc,EAAE,IADX;AAELC,kBAAY,EAAER,YAAY,CAACS,IAFtB;AAGLT,kBAAY,EAAZA,YAHK;AAILC,gBAAU,EAAVA,UAJK;AAKL;AACAS,iBAAW,EAAEL,UANR;AAOLM,qBAAe,EAAEC,EAAE,CAACC,kBAAH,EAPZ;AAQLC,mBAAa,EAAE,KARV;AASLC,iBAAW,EAAE,KATR,EAAP;;AAWD,GAbY;;AAebC,YAAU,EAAE,EAfC;AAgBbC,OAAK,EAAE;AACLC,YAAQ,EAAE;AACRC,UAAI,EAAEC,MADE;AAERC,aAAO,EAAE,4BAAO,EAAP,EAFD,EADL;;AAKLC,YAAQ,EAAE;AACRH,UAAI,EAAEI,MADE;AAERF,aAAO,EAAEvB,OAAO,CAACwB,QAAR,CAAiBE,WAFlB,EALL,EAhBM;;;;AA2Bb;AACAC,SA5Ba,qBA4BH,CAAE,CA5BC;;AA8BbC,aA9Ba,yBA8BC,CAAE,CA9BH;;AAgCbC,OAhCa,mBAgCL,CAAE,CAhCG;;AAkCbC,WAlCa,uBAkCD,CAAE,CAlCD;;AAoCbC,SApCa,qBAoCH,CAAE,CApCC;;AAsCbC,SAAO,EAAE;AACPC,uBADO,+BACaC,CADb,EACgB,CAAC;AACvB,KAFM;;AAIPC,qBAJO,+BAIa;AAClB,WAAKC,OAAL,CAAa;AACX1B,oBAAY,EAAE,KAAKA,YAAL,IAAqBR,YAAY,CAACS,IAAlC,GAAyCT,YAAY,CAACmC,IAAtD,GAA6DnC,YAAY,CAACS,IAD7E;AAEXC,mBAAW,EAAEL,UAFF,EAAb;;AAID,KATM;;AAWP+B,uBAXO,+BAWaJ,CAXb,EAWgB;AACrB,UAAIK,OAAO,GAAGL,CAAC,CAACK,OAAF,CAAU,CAAV,CAAd;AACA,UAAI9B,cAAc,GAAG,KAAKA,cAA1B;;AAEA,UAAI,CAACA,cAAL,EAAqB;AACnB;AACD;;AAED,UAAI,KAAKC,YAAL,IAAqBR,YAAY,CAACsC,KAAtC,EAA6C;AAC3C,YAAI/B,cAAc,CAACgC,KAAf,GAAuBF,OAAO,CAACE,KAA/B,GAAuC,EAA3C,EAA+C;AAC7C,eAAKL,OAAL,CAAa;AACX1B,wBAAY,EAAER,YAAY,CAACwC,IADhB,EAAb;;AAGD;AACF;;AAED,UAAI,KAAKhC,YAAL,IAAqBR,YAAY,CAACwC,IAAtC,EAA4C;AAC1C,YAAIjC,cAAc,CAACgC,KAAf,GAAuBF,OAAO,CAACE,KAA/B,GAAuC,EAA3C,EAA+C;AAC7C,eAAKL,OAAL,CAAa;AACX1B,wBAAY,EAAER,YAAY,CAACsC,KADhB,EAAb;;AAGD;AACF;AACF,KAlCM;;AAoCPG,mBApCO,2BAoCST,CApCT,EAoCY;AACjB,UAAIU,EAAE,GAAG,IAAT;AACAA,QAAE,CAACR,OAAH,CAAW;AACTpB,qBAAa,EAAE,IADN,EAAX;;AAGA6B,gBAAU,CAAC,YAAM;AACf,YAAID,EAAE,CAAC5B,aAAH,IAAoB,IAAxB,EAA8B;AAC5B8B,uBAAa;AACd;AACF,OAJS,EAIP,GAJO,CAAV;;AAMA,eAASA,aAAT,GAAyB;AACvBhC,UAAE,CAACiC,UAAH,CAAc;AACZC,iBAAO,EAAE,iBAAAC,GAAG,EAAI;AACd,gBAAIC,UAAU,GAAGD,GAAG,CAACE,WAAJ,CAAgB,cAAhB,CAAjB;;AAEA,gBAAID,UAAU,IAAI,KAAlB,EAAyB;AACvB;AACApC,gBAAE,CAACsC,WAAH,CAAe;AACbJ,uBAAO,EAAE,iBAAUC,GAAV,EAAe;AACtB,sBAAIC,UAAU,GAAGD,GAAG,CAACE,WAAJ,CAAgB,cAAhB,CAAjB;;AAEA,sBAAID,UAAU,IAAI,IAAlB,EAAwB;AACtBG,uBAAG,CAACC,SAAJ,CAAc;AACZC,2BAAK,EAAE,MADK;AAEZC,0BAAI,EAAE,SAFM,EAAd;;AAID,mBALD,MAKO;AACLH,uBAAG,CAACC,SAAJ,CAAc;AACZC,2BAAK,EAAE,OADK;AAEZC,0BAAI,EAAE,MAFM,EAAd;;AAID;;AAEDZ,oBAAE,CAACR,OAAH,CAAW;AACTnB,+BAAW,EAAE,KADJ,EAAX;;AAGD,iBAnBY,EAAf;;AAqBD,aAvBD,MAuBO,IAAIiC,UAAU,IAAI,IAAlB,EAAwB;AAC7B;AACAO,yBAAW;AACZ,aAHM,MAGA;AACL;AACA3C,gBAAE,CAAC4C,SAAH,CAAa;AACXC,qBAAK,EAAE,cADI;AAEXX,uBAAO,EAAE,mBAAM;AACb;AACAK,qBAAG,CAACC,SAAJ,CAAc;AACZC,yBAAK,EAAE,MADK;AAEZC,wBAAI,EAAE,SAFM,EAAd;;AAID,iBARU,EAAb;;AAUD;AACF,WA3CW;AA4CZI,cAAI,EAAE,gBAAY;AAChBP,eAAG,CAACC,SAAJ,CAAc;AACZC,mBAAK,EAAE,UADK;AAEZC,kBAAI,EAAE,MAFM,EAAd;;AAID,WAjDW,EAAd;;AAmDD;;AAED,eAASC,WAAT,GAAuB;AACrBb,UAAE,CAACnC,cAAH,GAAoByB,CAAC,CAACK,OAAF,CAAU,CAAV,CAApB;AACAK,UAAE,CAACR,OAAH,CAAW;AACT1B,sBAAY,EAAER,YAAY,CAACwC,IADlB,EAAX;;AAGApC,oBAAY,GAAG,IAAf;AACAsC,UAAE,CAACiB,OAAH;AACA,YAAIhD,eAAe,GAAG+B,EAAE,CAAC/B,eAAH,IAAsBC,EAAE,CAACC,kBAAH,EAA5C;AACAF,uBAAe,CAACiD,OAAhB,CAAwB,YAAM,CAAC;AAC9B,SADD;AAEAjD,uBAAe,CAACkD,KAAhB,CAAsB;AACpBC,gBAAM,EAAE,KADY,EAAtB;AAEI;;AAEJnB,kBAAU,CAAC,YAAY;AACrBD,YAAE,CAACqB,qBAAH;AACA3D,sBAAY,GAAG,KAAf;AACD,SAHS,EAGP,MAHO,CAAV;AAID;AACF,KAxHM;;AA0HP2D,yBA1HO,mCA0HiB;AACtB3D,kBAAY,GAAG,KAAf;AACA,UAAIO,eAAe,GAAG,KAAKA,eAA3B,CAFsB,CAEsB;;AAE5C,UAAI,KAAKH,YAAL,IAAqBR,YAAY,CAACsC,KAAtC,EAA6C;AAC3C,aAAKJ,OAAL,CAAa;AACX1B,sBAAY,EAAER,YAAY,CAACgE,OADhB,EAAb;;AAGD,OAJD,MAIO;AACL,aAAK9B,OAAL,CAAa;AACX1B,sBAAY,EAAER,YAAY,CAACS,IADhB;AAEXK,uBAAa,EAAE,KAFJ,EAAb;;AAID;;AAEDH,qBAAe,CAACsD,MAAhB,CAAuB,UAAAlB,GAAG,EAAI;AAC5B;AACA,YAAI,KAAI,CAACvC,YAAL,IAAqBR,YAAY,CAACgE,OAAtC,EAA+C;AAC7CE,iBAAO,CAACC,GAAR,CAAY,eAAZ;AACA,eAAI,CAACjC,OAAL,CAAa;AACX1B,wBAAY,EAAER,YAAY,CAACS,IADhB,EAAb;;AAGA;AACD;;AAED,YAAIsC,GAAG,CAACqB,QAAJ,GAAe,IAAnB,EAAyB;AACvBjB,aAAG,CAACC,SAAJ,CAAc;AACZC,iBAAK,EAAE,QADK;AAEZC,gBAAI,EAAE,MAFM,EAAd;;AAID,SALD,MAKO;AACL;AACA,eAAI,CAACe,YAAL,CAAkBtB,GAAG,CAACuB,YAAtB,EAAoCvB,GAAG,CAACqB,QAAxC;AACD;AACF,OAnBD,EAfsB,CAkClB;;AAEJzD,qBAAe,CAAC4D,IAAhB;AACD,KA/JM;;AAiKPC,eAjKO,yBAiKO;AACZ,aAAO,KAAKlD,QAAL,IAAiBxB,OAAO,CAACwB,QAAR,CAAiBmD,SAAzC;AACD,KAnKM;;AAqKPC,kBArKO,4BAqKU;AACf,aAAO,KAAKF,WAAL,KAAqB,KAAKtD,QAAL,CAAcyD,OAAnC,GAA6C,KAAKzD,QAAL,CAAc0D,IAAlE;AACD,KAvKM;;AAyKPP,gBAzKO,wBAyKMC,YAzKN,EAyKoBO,GAzKpB,EAyKyB;AAC9B,UAAIC,GAAG,GAAGlF,KAAK,CAACmF,MAAN,CAAaC,MAAb,CAAoBC,KAApB,CAA0B,GAA1B,CAAV;AACA,UAAIvC,EAAE,GAAG,IAAT;AACA,UAAIwC,KAAK,GAAGtF,KAAK,CAACuF,IAAN,CAAWC,OAAX,CAAmBC,WAA/B;AACAzE,QAAE,CAAC0E,UAAH,CAAc;AACZC,WAAG,EAAE,4BAA4BT,GAAG,CAAC,CAAD,CAA/B,GAAqC,GAArC,GAA2CA,GAAG,CAAC,CAAD,CAA9C,GAAoD,YAD7C;AAEZU,gBAAQ,EAAElB,YAFE;AAGZmB,YAAI,EAAE,MAHM;AAIZC,cAAM,EAAE;AACN,0BAAgB,qBADV;AAENC,uBAAa,EAAE,YAAYT,KAFrB,EAJI;;;AASZpC,eATY,mBASJC,GATI,EASC;AACX;AACA,cAAI6C,EAAE,GAAGhG,KAAK,CAACuF,IAAN,CAAWU,WAAX,EAAT;AACA,cAAIC,GAAG,GAAG,IAAIlG,KAAK,CAACmG,OAAV,CAAkBjG,OAAO,CAACkG,KAA1B,EAAiCJ,EAAjC,CAAV;AACA,cAAIK,OAAO,GAAGC,IAAI,CAACC,KAAL,CAAWpD,GAAG,CAACzC,IAAf,CAAd,CAJW,CAIyB;;AAEpCwF,aAAG,CAACM,GAAJ,CAAQ;AACNC,kBAAM,EAAEzG,KAAK,CAACmF,MAAN,CAAauB,MADf;AAENjB,uBAAW,EAAEH,KAFP;AAGNqB,gBAAI,EAAE;AACJpF,kBAAI,EAAErB,OAAO,CAACkG,KADV;AAEJT,iBAAG,EAAEU,OAAO,CAACO,GAAR,GAAc,GAAd,GAAoBP,OAAO,CAACQ,QAAR,CAAiB,CAAjB,EAAoBC,IAFzC;AAGJC,sBAAQ,EAAE,EAHN;AAIJC,sBAAQ,EAAEtC,YAJN;AAKJe,yBAAW,EAAEH,KALT;AAMJ2B,oBAAM,EAAEC,IAAI,CAACC,IAAL,CAAUlC,GAAG,GAAG,IAAhB,CANJ,EAHA;;AAWNmC,gBAAI,EAAEtE,EAAE,CAACxB,QAAH,CAAY+F,MAXZ;AAYNC,cAAE,EAAExE,EAAE,CAACgC,cAAH,EAZE;AAaNyC,oBAAQ,EAAE,KAbJ;AAcN7F,oBAAQ,EAAEoB,EAAE,CAACpB,QAdP;AAeNwB,mBAAO,EAAE,iBAAUsE,QAAV,EAAoB;AAC3BlH,kBAAI,CAACmH,IAAL,CAAU,qBAAV,EAAiCzB,EAAjC;AACD,aAjBK,EAAR;;;AAoBA,cAAIlD,EAAE,CAAC8B,WAAH,EAAJ,EAAsB;AACpBsB,eAAG,CAACwB,QAAJ,CAAa,WAAb;AACD;;AAEDxB,aAAG,CAACS,IAAJ,CAASM,MAAT,GAAkBC,IAAI,CAACC,IAAL,CAAUlC,GAAG,GAAG,IAAhB,CAAlB,CA9BW,CA8B8B;;AAEzCjF,eAAK,CAACuF,IAAN,CAAWoC,IAAX,CAAgBzB,GAAG,CAACS,IAApB;AACM,cAAIiB,GAAG,GAAG;AACR1B,eAAG,EAAEA,GADG;AAER3E,gBAAI,EAAErB,OAAO,CAACkG,KAFN,EAAV;;AAIAtD,YAAE,CAAC+E,WAAH,CAAeD,GAAf;AACP,SA/CW,EAAd;;;AAkDD,KA/NM;AAgOPC,eAhOO,uBAgOKC,GAhOL,EAgOU;AACfvH,gBAAU,CAACwH,OAAX,CAAmBD,GAAG,CAAC5B,GAAvB,EAA4B4B,GAAG,CAACvG,IAAhC;AACD,KAlOM;;AAoOPwC,WApOO,qBAoOG;AACR,UAAMiE,IAAI,GAAG,IAAb;AACA,UAAIC,YAAY,GAAGD,IAAI,CAAClH,WAAxB;;AAEA,WAAK,IAAIoH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,IAAI,CAAClH,WAAL,CAAiBmG,MAArC,EAA6CiB,CAAC,EAA9C,EAAkD;AAChD;AACAD,oBAAY,CAACC,CAAD,CAAZ,GAAkB,MAAMhB,IAAI,CAACiB,MAAL,GAAcC,OAAd,CAAsB,CAAtB,CAAN,GAAiC,EAAnD;AACD;;AAEDJ,UAAI,CAAC1F,OAAL,CAAa;AACXxB,mBAAW,EAAEmH,YADF,EAAb;;;AAIA,UAAIzH,YAAJ,EAAkB;AAChBuC,kBAAU,CAAC,YAAY;AACrBiF,cAAI,CAACjE,OAAL;AACD,SAFS,EAEP,GAFO,CAAV;AAGD,OAJD,MAIO;AACL;AACD;AACF,KAxPM,EAtCI,E;;;;;;;;;;;;;AC3Bf;AAAA;AAAA;AAAA;AAAowC,CAAgB,gmCAAG,EAAC,C;;;;;;;;;;;ACAxxC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"comps/chat/inputbar/suit/audio/audio.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./audio.vue?vue&type=template&id=5ed9fb7a&\"\nvar renderjs\nimport script from \"./audio.vue?vue&type=script&lang=js&\"\nexport * from \"./audio.vue?vue&type=script&lang=js&\"\nimport style0 from \"./audio.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/comps/chat/inputbar/suit/audio/audio.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./audio.vue?vue&type=template&id=5ed9fb7a&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./audio.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./audio.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nlet WebIM = require(\"../../../../../utils/WebIM\")[\"default\"];\nlet msgType = require(\"../../../msgtype\");\nlet RECORD_CONST = require(\"./record_status\");\nlet RecordStatus = RECORD_CONST.RecordStatus;\nlet RecordDesc = RECORD_CONST.RecordDesc;\nlet disp = require(\"../../../../../utils/broadcast\");\nlet msgStorage = require(\"../../../msgstorage\");\nlet RunAnimation = false;\nconst InitHeight = [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50];\n\nexport default {\n  data() {\n    return {\n      changedTouches: null,\n      recordStatus: RecordStatus.HIDE,\n      RecordStatus,\n      RecordDesc,\n      // 模板中有引用\n      radomheight: InitHeight,\n      recorderManager: wx.getRecorderManager(),\n      recordClicked: false,\n      isLongPress: false\n    };\n  },\n\n  components: {},\n  props: {\n    username: {\n      type: Object,\n      default: () => ({})\n    },\n    chatType: {\n      type: String,\n      default: msgType.chatType.SINGLE_CHAT\n    }\n  },\n\n  // lifetimes\n  created() {},\n\n  beforeMount() {},\n\n  moved() {},\n\n  destroyed() {},\n\n  mounted() {},\n\n  methods: {\n    toggleWithoutAction(e) {// 阻止 tap 冒泡\n    },\n\n    toggleRecordModal() {\n      this.setData({\n        recordStatus: this.recordStatus == RecordStatus.HIDE ? RecordStatus.SHOW : RecordStatus.HIDE,\n        radomheight: InitHeight\n      });\n    },\n\n    handleRecordingMove(e) {\n      var touches = e.touches[0];\n      var changedTouches = this.changedTouches;\n\n      if (!changedTouches) {\n        return;\n      }\n\n      if (this.recordStatus == RecordStatus.SWIPE) {\n        if (changedTouches.pageY - touches.pageY < 20) {\n          this.setData({\n            recordStatus: RecordStatus.HOLD\n          });\n        }\n      }\n\n      if (this.recordStatus == RecordStatus.HOLD) {\n        if (changedTouches.pageY - touches.pageY > 20) {\n          this.setData({\n            recordStatus: RecordStatus.SWIPE\n          });\n        }\n      }\n    },\n\n    handleRecording(e) {\n      let me = this;\n      me.setData({\n        recordClicked: true\n      });\n      setTimeout(() => {\n        if (me.recordClicked == true) {\n          executeRecord();\n        }\n      }, 350);\n\n      function executeRecord() {\n        wx.getSetting({\n          success: res => {\n            let recordAuth = res.authSetting['scope.record'];\n\n            if (recordAuth == false) {\n              //已申请过授权，但是用户拒绝\n              wx.openSetting({\n                success: function (res) {\n                  let recordAuth = res.authSetting['scope.record'];\n\n                  if (recordAuth == true) {\n                    uni.showToast({\n                      title: \"授权成功\",\n                      icon: \"success\"\n                    });\n                  } else {\n                    uni.showToast({\n                      title: \"请授权录音\",\n                      icon: \"none\"\n                    });\n                  }\n\n                  me.setData({\n                    isLongPress: false\n                  });\n                }\n              });\n            } else if (recordAuth == true) {\n              // 用户已经同意授权\n              startRecord();\n            } else {\n              // 第一次进来，未发起授权\n              wx.authorize({\n                scope: 'scope.record',\n                success: () => {\n                  //授权成功\n                  uni.showToast({\n                    title: \"授权成功\",\n                    icon: \"success\"\n                  });\n                }\n              });\n            }\n          },\n          fail: function () {\n            uni.showToast({\n              title: \"鉴权失败，请重试\",\n              icon: \"none\"\n            });\n          }\n        });\n      }\n\n      function startRecord() {\n        me.changedTouches = e.touches[0];\n        me.setData({\n          recordStatus: RecordStatus.HOLD\n        });\n        RunAnimation = true;\n        me.myradom();\n        let recorderManager = me.recorderManager || wx.getRecorderManager();\n        recorderManager.onStart(() => {// console.log(\"开始录音...\");\n        });\n        recorderManager.start({\n          format: \"mp3\"\n        }); // 超时\n\n        setTimeout(function () {\n          me.handleRecordingCancel();\n          RunAnimation = false;\n        }, 100000);\n      }\n    },\n\n    handleRecordingCancel() {\n      RunAnimation = false;\n      let recorderManager = this.recorderManager; // 向上滑动状态停止：取消录音发放\n\n      if (this.recordStatus == RecordStatus.SWIPE) {\n        this.setData({\n          recordStatus: RecordStatus.RELEASE\n        });\n      } else {\n        this.setData({\n          recordStatus: RecordStatus.HIDE,\n          recordClicked: false\n        });\n      }\n\n      recorderManager.onStop(res => {\n        // console.log(\"结束录音...\", res);\n        if (this.recordStatus == RecordStatus.RELEASE) {\n          console.log(\"user canceled\");\n          this.setData({\n            recordStatus: RecordStatus.HIDE\n          });\n          return;\n        }\n\n        if (res.duration < 1000) {\n          uni.showToast({\n            title: \"录音时间太短\",\n            icon: \"none\"\n          });\n        } else {\n          // 上传\n          this.uploadRecord(res.tempFilePath, res.duration);\n        }\n      }); // 停止录音\n\n      recorderManager.stop();\n    },\n\n    isGroupChat() {\n      return this.chatType == msgType.chatType.CHAT_ROOM;\n    },\n\n    getSendToParam() {\n      return this.isGroupChat() ? this.username.groupId : this.username.your;\n    },\n\n    uploadRecord(tempFilePath, dur) {\n      var str = WebIM.config.appkey.split(\"#\");\n      var me = this;\n      var token = WebIM.conn.context.accessToken;\n      wx.uploadFile({\n        url: \"https://a1.easemob.com/\" + str[0] + \"/\" + str[1] + \"/chatfiles\",\n        filePath: tempFilePath,\n        name: \"file\",\n        header: {\n          \"Content-Type\": \"multipart/form-data\",\n          Authorization: \"Bearer \" + token\n        },\n\n        success(res) {\n          // 发送 xmpp 消息\n          var id = WebIM.conn.getUniqueId();\n          var msg = new WebIM.message(msgType.AUDIO, id);\n          var dataObj = JSON.parse(res.data); // 接收消息对象\n\n          msg.set({\n            apiUrl: WebIM.config.apiURL,\n            accessToken: token,\n            body: {\n              type: msgType.AUDIO,\n              url: dataObj.uri + \"/\" + dataObj.entities[0].uuid,\n              filetype: \"\",\n              filename: tempFilePath,\n              accessToken: token,\n              length: Math.ceil(dur / 1000)\n            },\n            from: me.username.myName,\n            to: me.getSendToParam(),\n            roomType: false,\n            chatType: me.chatType,\n            success: function (argument) {\n              disp.fire('em.chat.sendSuccess', id);\n            }\n          });\n\n          if (me.isGroupChat()) {\n            msg.setGroup(\"groupchat\");\n          }\n\n          msg.body.length = Math.ceil(dur / 1000); //console.log('发送的语音消息', msg.body)\n\n          WebIM.conn.send(msg.body);\n                let obj = {\n                  msg: msg,\n                  type: msgType.AUDIO\n                }\n                me.saveSendMsg(obj);\n        }\n\n      });\n    },\n    saveSendMsg(evt) {\n      msgStorage.saveMsg(evt.msg, evt.type);\n    },\n\n    myradom() {\n      const that = this;\n      var _radomheight = that.radomheight;\n\n      for (var i = 0; i < that.radomheight.length; i++) {\n        //+1是为了避免为0\n        _radomheight[i] = 100 * Math.random().toFixed(2) + 10;\n      }\n\n      that.setData({\n        radomheight: _radomheight\n      });\n\n      if (RunAnimation) {\n        setTimeout(function () {\n          that.myradom();\n        }, 500);\n      } else {\n        return;\n      }\n    }\n\n  }\n};\n","import mod from \"-!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./audio.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./audio.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1589427990192\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}